<!DOCTYPE html>
<html lang="en">
<head>
    <link href="{{ url_for('static',filename='styles/style.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/bootstrap-theme.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/fileinput.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/icomoon.css') }}" rel="stylesheet">
</head>
{% include "header.html" %}
<body>
<div class="container">
    <div class="row">
        <div class="col-lg-12 col-sm-12 col-11 main-section">
            <h1 class="text-center text-primary"> stackoverflow questions taging generator </h1><br>
            <form id="formsTagPredictor" onsubmit="sendForm(this.id);return false" method="post">
                <div class="form-group">
                    <textarea class="form-control" rows="5" id="question" name="question"></textarea>
                </div>
                <button id="test" class="btn btn-primary">Predict tags</button>

            </form>
            <div id="wait" style="display: none;">
                <img src="{{ url_for('static',filename='img/loading.gif') }}">
            </div>
            <div >
                <div id="resultdiv"></div>
                <div class="container" style="margin-top: 2%; height: 300px;">
                    <div class="row">
                        <div id="logisticresultdividf" class="col-lg-5 rescontain">

                        </div>
                        <div id="sgdcresultdividf" class="col-lg-5 rescontain" >

                        </div>
                        <div id="logisticresultdivw2v" class="col-lg-5 rescontain" >

                        </div>
                        <div id="sgdcresultdivw2v" class="col-lg-5 rescontain" >

                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>
</div>
{% include "footer.html" %}
<script src="{{ url_for('static',filename='javascript/jquery-3.2.1.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static',filename='javascript/bootstrap.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static',filename='javascript/fileinput.js') }}" type="text/javascript"></script>
<script>


    function sendForm(form_id) {
        console.log('passge function ajax');
        $('#logisticresultdividf').empty();
        $('#sgdcresultdividf').empty();
        $('#logisticresultdivw2v').empty();
        $('#sgdcresultdivw2v').empty();
        $('#resultdiv').empty();

        var form = $('#' + form_id);
        if ($('#question').val().trim() != '') {
            $('#wait').show();
            $.ajax({
                type: 'POST',
                url: '/tagGenerators',
                data: $(form).serialize(),
                success: function (result) {
                    $('#wait').hide();
                    console.log('reponse');

                    if (result['tfidf_logistic'].length >= 1) {
                        console.log('reponse result tfidf');
                        $('#logisticresultdividf').append("<label>LOGISTIC model with tf-idf</label>");
                        result['tfidf_logistic'].forEach((item) => {
                            console.log(item);
                            console.log(result['tfidf_logistic_proba'][item]);
                            probres = result['tfidf_logistic_proba'][item] * 100;
                            $('#logisticresultdividf').append("<div style='margin-top: 2%'><button type='button' class='btn btn-warning'><label>#" + item + " </label></button>  conf : " + Math.round(probres) + "% <progress max='100' value='" + probres + "'> </progress></div> ");
                        })
                    }

                    if (result['tfidf_sgdc'].length >= 1) {
                        console.log('reponse result tfidf');
                        $('#sgdcresultdividf').append("<label>SGDC model with tf-idf</label>");
                        result['tfidf_sgdc'].forEach((item) => {
                            console.log(item);
                            console.log(result['tfidf_sgdc_proba'][item]);
                            probres = result['tfidf_sgdc_proba'][item] * 100;
                            $('#sgdcresultdividf').append("<div style='margin-top: 2%'><button type='button' class='btn btn-warning'><label>#" + item + " </label></button>  conf : " + Math.round(probres) + "% <progress max='100' value='" + probres + "'> </progress></div> ");
                        })
                    }

                    if (result['w2v_logistic'].length >= 1) {
                        console.log('reponse result w2v');
                        $('#logisticresultdivw2v').append("<label>LOGISTIC model with word2vec</label>");
                        result['w2v_logistic'].forEach((item) => {
                            console.log(item);
                            console.log(result['w2v_logistic_proba'][item]);
                            probres = result['w2v_logistic_proba'][item] * 100;
                            $('#logisticresultdivw2v').append("<div style='margin-top: 2%'><button type='button' class='btn btn-warning'><label>#" + item + " </label></button>  conf : " + Math.round(probres) + "% <progress max='100' value='" + probres + "'> </progress></div> ");
                        })
                    }

                    if (result['w2v_sgdc'].length >= 1) {
                        console.log('reponse result w2v');
                        $('#sgdcresultdivw2v').append("<label>SGDC model with word2vec</label>");
                        result['w2v_sgdc'].forEach((item) => {
                            console.log(item);
                            console.log(result['w2v_sgdc_proba'][item]);
                            probres = result['w2v_sgdc_proba'][item] * 100;
                            $('#sgdcresultdivw2v').append("<div style='margin-top: 2%'><button type='button' class='btn btn-warning'><label>#" + item + " </label></button>  conf : " + Math.round(probres) + "% <progress max='100' value='" + probres + "'> </progress></div> ");
                        })
                    }

                    if ((result['tfidf_logistic'].length == 0 && result['tfidf_sgdc'].length == 0 && result['w2v_logistic'].length == 0 && result['w2v_sgdc'].length == 0 )) {
                        $('#resultdiv').append("No results...");
                    }


                }
            });
        }else{
            $('#resultdiv').append("No results...");
        }
    }


</script>

</body>
</html>