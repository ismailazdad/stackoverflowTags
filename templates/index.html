<!DOCTYPE html>
<html lang="en">
<head>
    <link href="{{ url_for('static',filename='styles/style.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/bootstrap-theme.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/fileinput.css') }}" rel="stylesheet">
    <link href="{{ url_for('static',filename='styles/icomoon.css') }}" rel="stylesheet">
</head>
{% include "header.html" %}
<body>
<div class="container">
    <div class="row">
        <div class="col-lg-12 col-sm-12 col-11 main-section">
            <h1 class="text-center text-primary"> stackoverflow questions taging generator </h1><br>
            <form id="formsTagPredictor"  onsubmit="sendForm(this.id);return false" method="post">
                <div class="form-group">
                    <textarea class="form-control" rows="5" id="question" name="question" ></textarea>
                </div>
                <button id="test" class="btn btn-primary">Predict tags</button>

            </form>

            <div id="resultdiv" class="col-lg-8 col-sm-8">

            </div>

        </div>
    </div>
</div>
</div>
{% include "footer.html" %}
<script src="{{ url_for('static',filename='javascript/jquery-3.2.1.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static',filename='javascript/bootstrap.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static',filename='javascript/fileinput.js') }}" type="text/javascript"></script>
<script>

    //$(document).ready(function () {
        function sendForm(form_id){
            console.log('passge function ajax');
            $('#resultdiv').empty()
            var form = $('#'+form_id);
            $.ajax({
                type: 'POST',
                url: '/tagGenerators',
                data: $(form).serialize(),
                success: function(result) {
                    console.log('reponse');
                    if(result['tfidf'].length >= 1){
                        console.log('reponse result tfidf');
                        $('#resultdiv').append("<label>logistic model with tfidf</label>");
                        result['tfidf'].forEach((item) => {
                            console.log(item);
                            console.log(result['tfidf_proba'][item]);
                            probres = result['tfidf_proba'][item] * 100;
                            $('#resultdiv').append("<div> <label> "+ item +" </label> : predictions convidence : "+Math.round(probres)+"% <progress max='100' value='"+probres+"'> </progress></div> ");
                        })
                    }

                    if(result['w2v'].length >= 1){
                        console.log('reponse result w2v');
                        $('#resultdiv').append("<label>logistic model with w2v</label>");
                        result['w2v'].forEach((item) => {
                            console.log(item);
                            console.log(result['w2v_proba'][item]);
                            probres = result['w2v_proba'][item] * 100;
                            $('#resultdiv').append("<div> <label> "+ item +" </label> : predictions convidence : "+Math.round(probres)+"% <progress max='100' value='"+probres+"'> </progress></div> ");
                        })
                    }

                    console.log(result);
                }
            });
        }

    //});
</script>

</body>
</html>